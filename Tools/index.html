<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>首页</title>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/app/index.css" />
		<link href="css/iconfont.css" rel="stylesheet" />

		<link title="default" rel="stylesheet" type="text/css" href="css/app/default.css" />
		<link title="dark" rel="stylesheet" type="text/css" href="css/app/dark-theme.css" disabled="disabled" />
		<script type="text/javascript" src="js/app/theme.js"></script>
		<style>
			/*.mui-control-content {
				background-color: white;
				min-height: 300px;
			}*/
			
			.mui-control-content .mui-loading {
				margin-top: 50px;
			}
			
			.mui-col-xs-4 {
				width: 33.3% !important;
			}
			
			.web-item {
				height: 75px;
				border-radius: 5px;
			}
			
			.web-left {
				width: 69%;
				height: 100%;
				float: left;
			}
			
			.web-left-1 {
				color: #000000;
				margin-top: 10px;
				margin-left: 10px;
				font-size: 14px;
				text-align: left;
			}
			
			.web-left-2 {
				font-size: 12px;
				margin-left: 10px;
				color: #000000;
				text-align: left;
			}
			
			.web-right {
				width: 30%;
				height: 100%;
				float: right;
			}
			
			.web-right-img {
				width: 30px;
				height: 30px;
				border-radius: 15px;
				margin-top: 10px;
				padding: 5px;
				color: #FFFFFF;
			}
		</style>
	</head>

	<body>
		<!--
        	描述：弹出层
        -->
		<!--<div id="popup-content">
			<iframe id="huoduan_frame" frameborder="0" scrolling="yes" name="main" src="" 
				style=" height:100%; visibility: inherit; width: 100%; z-index: 1;overflow: visible;">
			</iframe>
			
		</div>-->

		<div class="mui-content">
			<div id="weather-home-page" class="mui-control-content mui-active">
				<!-- 天气头部区域 -->
				<header class="mui-bar mui-bar-nav detail-nav" style="height: 50px;">
					<!--<a class="mui-icon mui-icon-plusempty mui-pull-left add-location select-location my-nav-icon"></a>-->
					<!--<span class="cur-location">我的收藏</span>-->
					<a class="iconfont icon-shezhi mui-pull-right shezhi" style="color: #FFFFFF;margin-top: 10px;font-size: 18px;"></a>
					<!--<a class="mui-icon mui-icon-search mui-pull-right" style="color: #FFFFFF;margin-right: 5%;"></a>-->
					<div class="city-index-view " style="color: white;width: 90%;margin-top: 10px;">

						我哪有什么好脾气，我的好脾气都是因为我爱你。
						<!--
                        	作者：1129705469@qq.com
                        	时间：2017-09-08
                        	描述：一句API（官方文档：http://yuaua.com/yiju_api.html）
                       -->
						<!--<script type="text/javascript" src="http://yiju.ml/api/word.php?m=js"></script>
						<script>
							document.write("<div style=\"text-align:left\">" + str[0] + "</div><div style=\"text-align:left\">——" + str[1] + "</div>");
						</script>-->
					</div>
				</header>

				<!-- 当前位置天气显示区域 background-image: url(images/weather-bg/weather2.jpg);-->
				<div class="cur-weather module-tap" id="weather-bg" style="background-color:rgba(27,130,210,255);background-size: cover;">
					<!-- 当前城市天气详情显示 -->
					<div class="cur-weather-detail">
						<div class="cur-weather-detail-left">
							<div class="cur-temperature"><span class="cur-font-color" id="time"></span><span id="seconds" style="font-size: 20px;"></span></div>
							<div class="cur-weather-otherinfo">
								<!-- 日期 -->
								<span style="font-size: 12px;" class="bg-font-color" id="date"></span>
								<span style="font-size: 12px;margin-left: 10px;" class="update-time bg-font-color" id="week"></span>

							</div>
						</div>

					</div>
					<div class="header-img"></div>
				</div>
				<div class="weather-more-info" style="margin-top: 20px;">
					<!--<div id="show-display" style="text-align: center;margin-top: 45%;color: #A2A2A2;font-size: 25px;">
						暂无收藏
					</div>-->
					<div class="city-item web-item" style="">
						<div class="web-left">
							<h5 class="web-left-1">音乐搜索器</h5>
							<h5 class="web-left-2">一些音乐商的音乐下载</h5>
						</div>
						<div class="web-right">
							<div class="web-right-img" style="background-color: #05A47B;">
								<p style="color: #FFFFFF;font-size: 10px;">音乐</p>
							</div>
							<div style="height: 30px;background-color: red;color:#FFFFFF;line-height: 30px;border-radius: 50px 0 0 0;padding-left: 10px;">new</div>
						</div>
					</div>
					<div class="city-item web-item" style="">
						<div class="web-left">
							<h5 class="web-left-1">百度图片</h5>
							<h5 class="web-left-2"></h5>
						</div>
						<div class="web-right">
							<div class="web-right-img" style="background-color: #000000;">
								<p style="color: #FFFFFF;font-size: 10px;">度娘</p>
							</div>
							<div style="height: 30px;background-color: red;color:#FFFFFF;line-height: 30px;border-radius: 50px 0 0 0;padding-left: 10px;">new</div>
						</div>
					</div>
					<div class="city-item web-item">
						<div class="web-left">
							<h5 class="web-left-1">图片直链获取</h5>
							<h5 class="web-left-2"></h5>
						</div>
						<div class="web-right">
							<div class="web-right-img" style="background-color:#0062CC;">
								<p style="color: #FFFFFF;font-size: 10px;">pic</p>
							</div>
							<div style="height: 30px;background-color: red;color:#FFFFFF;line-height: 30px;border-radius: 50px 0 0 0;padding-left: 10px;">new</div>
						</div>
					</div>

					
				</div>
			</div>
		</div>

		<script src="js/util.js"></script>
		<script type="text/javascript">
			var aniShow = {};
			var flag = false;
			mui.init({
				swipeBack: false,
				keyEventBind: {
					backbutton: true // 打开back按键监听
				},
				// 配置具体需要监听的手势事件
				gestureConfig: {
					longtap: true, // 手机端长按事件，默认为 false
				}
			});

			// 移动端back键事件
			//			var first = null;
			mui.back = function() {

				var btn = ["取消", "确定"];
				mui.confirm('确定要退出应用程序吗？', '百宝侠', btn, function(e) {
					if(e.index == 1) {
						plus.runtime.quit(); // 退出APP
					}
				});
				//首次按键，提示‘再按一次退出应用’
				//                  if (!first) {
				//                      first = new Date().getTime();
				//                      mui.toast('再按一次退出应用');
				//                      setTimeout(function() {
				//                          first = null;
				//                      }, 1000);
				//                  } else {
				//                      if (new Date().getTime() - first < 1000) {
				//                          plus.runtime.quit();
				//                      }
				//                  }

			}

			//获取时间start
			setInterval("getTime()", 1000); //每隔一秒执行一次 
			var weekArray = new Array("日", "一", "二", "三", "四", "五", "六");

			function getTime() {
				var myDate = new Date();
				var date = myDate.toLocaleDateString();
				var week = myDate.getDay();
				var hours = myDate.getHours();
				var minutes = myDate.getMinutes();
				var seconds = myDate.getSeconds();
				if(minutes < 10) {
					minutes = '0' + minutes;
				}
				if(seconds < 10) {
					seconds = '0' + seconds;
				}
				$("#time").html(hours + ":" + minutes);
				$("#seconds").html(":" + seconds);
				$("#date").html(date);
				$("#week").html('周' + weekArray[week]);
			}
			//获取时间end

			mui.plusReady(function() {

				//设置弹出层尺寸
				//				var popup_Height = (screen.height-80)+'px';
				//				var popup_Width = (screen.width-10)+'px';
				//				document.getElementById('popup-content').style.minHeight = popup_Height;
				//				document.getElementById('popup-content').style.width = popup_Width;
				//				document.getElementById('huoduan_frame').style.minHeight = popup_Height;

				var self = plus.webview.currentWebview(),
					nviews = self.getSubNViews(),
					subpages = util.options.subpages,
					leftPos = Math.ceil((window.innerWidth - 60) / 2); // 设置凸起大图标为水平居中

				/**	
				 * drawNativeIconBg 绘制带边框的半圆，
				 * 实现原理：
				 *   id为bg的tag 创建带边框的圆
				 *   id为bg2的tag 创建白色矩形遮住圆下半部分，只显示凸起带边框部分
				 *   注意创建先后顺序，创建越晚的层级越高
				 */
				var drawNativeIconBg = util.drawNative('iconBg', {
					bottom: '5px',
					left: leftPos + 'px',
					width: '60px',
					height: '60px'
				}, [{
					tag: 'rect',
					id: 'bg',
					position: {
						top: '0px',
						left: '0px',
						width: '100%',
						height: '100%'
					},
					rectStyles: {
						color: '#fff',
						radius: '30px',
						borderColor: '#ccc',
						borderWidth: '1px'
					}
				}, {
					tag: 'rect',
					id: 'bg2',
					position: {
						bottom: '0px',
						left: '0px',
						width: '100%',
						height: '45px'
					},
					rectStyles: {
						color: '#fff'
					}
				}]);

				/**
				 * 凸起图标最后创建  浮在最顶层
				 *	id为iconBg的红色背景图
				 * 	id为icon的字体图标
				 * 	
				 */
				var drawNativeIcon = util.drawNative('tabIcon', {
					bottom: '10px',
					left: leftPos + 5 + 'px',
					width: '50px',
					height: '50px',
//					position: 'dock' //此种停靠方式表明该控件应浮在窗口最上层，以免被其他窗口遮住
				}, [{
					tag: 'rect',
					id: 'iconBg',
					position: {
						top: '0px',
						left: '0px',
						width: '50px',
						height: '100%'
					},
					rectStyles: {
						//						color: '#d74b28',
						color: '#ff1b82d2',
						size: '50px',
						radius: '50%'
					}
				}, {
					tag: 'font',
					id: 'icon',
					text: '\ue6af', //此为字体图标Unicode码'\e600'转换为'\ue600'
					position: {
						top: '0px',
						left: '0px',
						width: '50px',
						height: '100%'
					},
					textStyles: {
						fontSrc: '_www/fonts/iconfont.ttf',
						align: 'center',
						color: '#fff',
						size: '30px'
					}
				}]);
				// append 到父webview中
				self.append(drawNativeIconBg);
				self.append(drawNativeIcon);

				//自定义监听图标点击事件
				drawNativeIcon.addEventListener('click', function(e) {
					//					mui.confirm('你点击了图标，你在此可以打开摄像头或者新窗口等自定义点击事件。', '悬浮球点击事件');
					//					document.getElementById('popup-content').style.display='block';
					//					document.getElementById('huoduan_frame').src = 'https://www.coolapk.com/'; 

					var file = [];
					file['mp3'] = 'http://fjdx.sc.chinaz.com/Files/DownLoad/sound1/201704/8596.mp3';
					if(flag == false) {
						flag = true;
						/*开始播放声音*/
						audioplayer('audioplane', file, false);

						// 重绘字体颜色
						drawNativeIcon.drawText('\ue6af', {}, {
							fontSrc: '_www/fonts/iconfont.ttf',
							align: 'center',
							color: '#000',
							size: '30px'
						}, 'icon');
					} else {
						flag = false;
						/*停止播放声音*/
						audioplayer('audioplane');
						// 重绘字体颜色
						drawNativeIcon.drawText('\ue6af', {}, {
							fontSrc: '_www/fonts/iconfont.ttf',
							align: 'center',
							color: '#FFFFFF',
							size: '30px'
						}, 'icon');

					}

				});

				/*
					    用法示例：
					    var file = [];
					    file['mp3'] = '1.mp3';
					    file['ogg'] = '1.ogg';
					    // 播放
					    audioplayer('audioplane', file, true);
					     // 停止
					    audioplayer('audioplane');
					*/
				/** 音乐播放器 * @param obj 播放器id * @param file 音频文件 mp3: ogg: * @param loop 是否循环 */
				function audioplayer(id, file, loop) {
					var audioplayer = document.getElementById(id);
					if(audioplayer != null) {
						document.body.removeChild(audioplayer);
					}
					if(typeof(file) != 'undefined') {
						if(navigator.userAgent.indexOf("MSIE") > 0) {
							// IE
							var player = document.createElement('bgsound');
							player.id = id;
							player.src = file['mp3'];
							player.setAttribute('autostart', 'true');
							if(loop) {
								player.setAttribute('loop', 'infinite');
							}
							document.body.appendChild(player);
						} else {
							// Other FF Chome Safari Opera
							var player = document.createElement('audio');
							player.id = id;
							player.setAttribute('autoplay', 'autoplay');
							if(loop) {
								player.setAttribute('loop', 'loop');
							}
							document.body.appendChild(player);
							var mp3 = document.createElement('source');
							mp3.src = file['mp3'];
							mp3.type = 'audio/mpeg';
							player.appendChild(mp3);
							var ogg = document.createElement('source');
							ogg.src = file['ogg'];
							ogg.type = 'audio/ogg';
							player.appendChild(ogg);
						}
					}
				}

				//创建子webview窗口 并初始化
				util.initSubpage();
				var activePage = plus.webview.currentWebview();

				//给每个view 添加监听点击切换
				for(var i = 0; i < 4; i++) {
					nviews[i].addEventListener('click', clickEvent, false);
				}

				// 自定义 tab 点击事件
				function clickEvent(e) {
					var currId = e.target.id,
						currIndex = parseInt(currId.substr(currId.length - 1, 1) - 1),
						currView = self.getStyle().subNViews[currIndex];

					// 匹配对应tab窗口	
					if(currIndex > 0) {
						targetPage = plus.webview.getWebviewById(subpages[currIndex - 1]);
					} else {
						targetPage = plus.webview.currentWebview();
					}

					if(targetPage == activePage) {
						return;
					}

					if(currIndex !== 3) {
						//底部选项卡切换
						util.toggleNview(currView, currIndex);
						// 子页面切换
						util.changeSubpage(targetPage, activePage);
						//更改当前活跃的页面
						activePage = targetPage;
					} else {
						//第四个tab 打开新窗口
						var newWV = plus.webview.create('html/new-webview.html', 'new');
						newWV.show('slide-in-right', 500);
					}
				}
			});
		</script>
		<script type="text/javascript" src="js/app/index.js"></script>
	</body>

</html>